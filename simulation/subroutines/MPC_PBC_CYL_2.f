      SUBROUTINE MPC(UE,A,JDOF,MDOF,N,JTYPE,X,U,UINIT,MAXDOF,LMPC,
     * KSTEP,KINC,TIME,NT,NF,TEMP,FIELD,LTRAN,TRAN)
C
      INCLUDE 'ABA_PARAM.INC'
C
      DIMENSION UE(MDOF),A(MDOF,MDOF,N),JDOF(MDOF,N),X(6,N),
     * U(MAXDOF,N),UINIT(MAXDOF,N),TIME(2),TEMP(NT,N),
     * FIELD(NF,NT,N),LTRAN(N),TRAN(3,3,N)
C     Input Parameters
      RR = 0
      RPhi = 0
      RZ = 0

C     Reference point
      Urp_1 = U(1,3)
      Urp_2 = U(2,3)
      Urp_3 = U(3,3)


C     Node A
      Xa_R   = SQRT(X(1,1)*X(1,1)+X(2,1)*X(2,1))
      Xa_Phi = ATAN2(X(2,1),X(1,1))
      Xa_Z   = X(3,1)
      Ua_R   = SQRT((X(1,1)+U(1,1))*(X(1,1)+U(1,1))+(X(2,1)+U(2,1))*(X(2,1)+U(2,1)))-Xa_R
      Ua_Phi = ATAN2((X(2,1)+U(2,1)),(X(1,1)+U(1,1)))-Xa_Phi
      Ua_Z = U(3,1)

C     Node B 
      Xb_R   = SQRT(X(1,2)*X(1,2)+X(2,2)*X(2,2))
      Xb_Phi = ATAN2(X(2,2),X(1,2))
      Xb_Z   = X(3,2)
      Ub_R   = SQRT((X(1,2)+U(1,2))*(X(1,2)+U(1,2))+(X(2,2)+U(2,2))*(X(2,2)+U(2,2)))-Xb_R
      Ub_Phi = ATAN2((X(2,2)+U(2,2)),(X(1,2)+U(1,2)))-Xb_Phi
      Ub_Z = U(3,2)
C     Begin Iterations
      IF (JTYPE .EQ. 0) THEN
      UE(1) = cos(atan2(U(2,2),U(1,2))+atan2(U(2,1)+X(2,1),U(1,1)+X(1,1)
     *  )-atan2(U(2,2)+X(2,2),U(1,2)+X(1,2)))*sqrt(U(1,2)**2+U(2,2)**2)
      UE(2) = sin(atan2(U(2,2),U(1,2))+atan2(U(2,1)+X(2,1),U(1,1)+X(1,1)
     *  )-atan2(U(2,2)+X(2,2),U(1,2)+X(1,2)))*sqrt(U(1,2)**2+U(2,2)**2)
      UE(3) = U(3,2)+U(3,3)*(X(3,1)-X(3,2))
      UE(4) = (U(4,2)*cos(atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*
     *  1.0D0/sqrt(abs(U(4,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(
     *  5,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)
     *  **2+U(5,2)**2+U(6,2)**2))*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)
     *  **2)-U(5,2)*sin(atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0
     *  /sqrt(abs(U(4,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))
     *  **2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(
     *  5,2)**2+U(6,2)**2))*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2))*
     *  sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)
      UE(5) = (U(5,2)*cos(atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*
     *  1.0D0/sqrt(abs(U(4,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(
     *  5,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)
     *  **2+U(5,2)**2+U(6,2)**2))*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)
     *  **2)+U(4,2)*sin(atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0
     *  /sqrt(abs(U(4,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))
     *  **2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(
     *  5,2)**2+U(6,2)**2))*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2))*
     *  sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)
      UE(6) = (U(6,2)*cos(atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*
     *  1.0D0/sqrt(abs(U(4,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(
     *  5,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)
     *  **2+U(5,2)**2+U(6,2)**2))*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)
     *  **2)-U(6,2)*(cos(atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))-
     *  1.0D0)*1.0D0/sqrt(abs(U(4,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)
     *  +abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(
     *  U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U
     *  (6,2)**2))*sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)
      A(1,1,1) = -(sin(atan2(U(2,2),U(1,2))+atan2(U(2,1)+X(2,1),U(1,1)+X
     *  (1,1))-atan2(U(2,2)+X(2,2),U(1,2)+X(1,2)))*sqrt(U(1,2)**2+U(2,2)
     *  **2)*(U(2,1)+X(2,1)))/((U(1,1)+X(1,1))**2+(U(2,1)+X(2,1))**2)
     *  +1.0D0
      A(1,2,1) = (sin(atan2(U(2,2),U(1,2))+atan2(U(2,1)+X(2,1),U(1,1)+X(
     *  1,1))-atan2(U(2,2)+X(2,2),U(1,2)+X(1,2)))*sqrt(U(1,2)**2+U(2,2)
     *  **2)*(U(1,1)+X(1,1)))/((U(1,1)+X(1,1))**2+(U(2,1)+X(2,1))**2)
      A(2,1,1) = (cos(atan2(U(2,2),U(1,2))+atan2(U(2,1)+X(2,1),U(1,1)+X(
     *  1,1))-atan2(U(2,2)+X(2,2),U(1,2)+X(1,2)))*sqrt(U(1,2)**2+U(2,2)
     *  **2)*(U(2,1)+X(2,1)))/((U(1,1)+X(1,1))**2+(U(2,1)+X(2,1))**2)
      A(2,2,1) = -(cos(atan2(U(2,2),U(1,2))+atan2(U(2,1)+X(2,1),U(1,1)+X
     *  (1,1))-atan2(U(2,2)+X(2,2),U(1,2)+X(1,2)))*sqrt(U(1,2)**2+U(2,2)
     *  **2)*(U(1,1)+X(1,1)))/((U(1,1)+X(1,1))**2+(U(2,1)+X(2,1))**2)
     *  +1.0D0
      A(3,3,1) = 1.0D0
      A(4,4,1) = 1.0D0
      A(5,5,1) = 1.0D0
      A(6,6,1) = 1.0D0
      A(1,1,2) = -sin(atan2(U(2,2),U(1,2))+atan2(U(2,1)+X(2,1),U(1,1)+X(
     *  1,1))-atan2(U(2,2)+X(2,2),U(1,2)+X(1,2)))*sqrt(U(1,2)**2+U(2,2)
     *  **2)*(U(2,2)/(U(1,2)**2+U(2,2)**2)-(U(2,2)+X(2,2))/((U(1,2)+X(1,
     *  2))**2+(U(2,2)+X(2,2))**2))-U(1,2)*cos(atan2(U(2,2),U(1,2))
     *  +atan2(U(2,1)+X(2,1),U(1,1)+X(1,1))-atan2(U(2,2)+X(2,2),U(1,2)+X
     *  (1,2)))*1.0D0/sqrt(U(1,2)**2+U(2,2)**2)
      A(1,2,2) = sin(atan2(U(2,2),U(1,2))+atan2(U(2,1)+X(2,1),U(1,1)+X(1
     *  ,1))-atan2(U(2,2)+X(2,2),U(1,2)+X(1,2)))*sqrt(U(1,2)**2+U(2,2)**
     *  2)*(U(1,2)/(U(1,2)**2+U(2,2)**2)-(U(1,2)+X(1,2))/((U(1,2)+X(1,2)
     *  )**2+(U(2,2)+X(2,2))**2))-U(2,2)*cos(atan2(U(2,2),U(1,2))+atan2(
     *  U(2,1)+X(2,1),U(1,1)+X(1,1))-atan2(U(2,2)+X(2,2),U(1,2)+X(1,2)))
     *  *1.0D0/sqrt(U(1,2)**2+U(2,2)**2)
      A(2,1,2) = cos(atan2(U(2,2),U(1,2))+atan2(U(2,1)+X(2,1),U(1,1)+X(1
     *  ,1))-atan2(U(2,2)+X(2,2),U(1,2)+X(1,2)))*sqrt(U(1,2)**2+U(2,2)**
     *  2)*(U(2,2)/(U(1,2)**2+U(2,2)**2)-(U(2,2)+X(2,2))/((U(1,2)+X(1,2)
     *  )**2+(U(2,2)+X(2,2))**2))-U(1,2)*sin(atan2(U(2,2),U(1,2))+atan2(
     *  U(2,1)+X(2,1),U(1,1)+X(1,1))-atan2(U(2,2)+X(2,2),U(1,2)+X(1,2)))
     *  *1.0D0/sqrt(U(1,2)**2+U(2,2)**2)
      A(2,2,2) = -cos(atan2(U(2,2),U(1,2))+atan2(U(2,1)+X(2,1),U(1,1)+X(
     *  1,1))-atan2(U(2,2)+X(2,2),U(1,2)+X(1,2)))*sqrt(U(1,2)**2+U(2,2)
     *  **2)*(U(1,2)/(U(1,2)**2+U(2,2)**2)-(U(1,2)+X(1,2))/((U(1,2)+X(1,
     *  2))**2+(U(2,2)+X(2,2))**2))-U(2,2)*sin(atan2(U(2,2),U(1,2))
     *  +atan2(U(2,1)+X(2,1),U(1,1)+X(1,1))-atan2(U(2,2)+X(2,2),U(1,2)+X
     *  (1,2)))*1.0D0/sqrt(U(1,2)**2+U(2,2)**2)
      A(3,3,2) = -1.0D0
      A(4,4,2) = -sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)*(cos(atan2(X(2,1),
     *  X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2))**2/(U(4,2)
     *  **2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6
     *  ,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/
     *  sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)-U(4,2)**2*cos(atan2(X(2,1),X
     *  (1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2))**2/(U(4,2)**
     *  2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2
     *  )**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/(U(4
     *  ,2)**2+U(5,2)**2+U(6,2)**2)**(3.0D0/2.0D0)+U(4,2)*U(5,2)*sin(
     *  atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2)
     *  )**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U
     *  (5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**
     *  2))*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**(3.0D0/2.0D0)+(U(4,2)
     *  *cos(atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/(abs(U(4,2
     *  ))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**
     *  2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2
     *  )**2))**(3.0D0/2.0D0)*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)*
     *  (U(4,2)*abs(U(4,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**2*
     *  2.0D0+U(4,2)*abs(U(5,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2
     *  )**2*2.0D0+U(4,2)*abs(U(6,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,
     *  2)**2)**2*2.0D0-(abs(U(4,2))*((U(4,2)/abs(U(4,2))))*2.0D0)/(U(4,
     *  2)**2+U(5,2)**2+U(6,2)**2)))/2.0D0-(U(5,2)*sin(atan2(X(2,1),X(1,
     *  1))-atan2(X(2,2),X(1,2)))*1.0D0/(abs(U(4,2))**2/(U(4,2)**2+U(5,2
     *  )**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)
     *  +abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))**(3.0D0/2.0D0)*
     *  1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)*(U(4,2)*abs(U(4,2))**2
     *  *1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**2*2.0D0+U(4,2)*abs(U(5,2
     *  ))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**2*2.0D0+U(4,2)*abs(
     *  U(6,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**2*2.0D0-(abs(U
     *  (4,2))*((U(4,2)/abs(U(4,2))))*2.0D0)/(U(4,2)**2+U(5,2)**2+U(6,2)
     *  **2)))/2.0D0)-U(4,2)*(U(4,2)*cos(atan2(X(2,1),X(1,1))-atan2(X(2,
     *  2),X(1,2)))*1.0D0/sqrt(abs(U(4,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2
     *  )**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))
     *  **2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/sqrt(U(4,2)**2+U(5,2)
     *  **2+U(6,2)**2)-U(5,2)*sin(atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,
     *  2)))*1.0D0/sqrt(abs(U(4,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)
     *  +abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(
     *  U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U
     *  (6,2)**2))*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)
      A(4,5,2) = sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)*(sin(atan2(X(2,1),X
     *  (1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2))**2/(U(4,2)**
     *  2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2
     *  )**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/sqrt
     *  (U(4,2)**2+U(5,2)**2+U(6,2)**2)-U(5,2)**2*sin(atan2(X(2,1),X(1,1
     *  ))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2))**2/(U(4,2)**2+U(
     *  5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2
     *  )+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/(U(4,2)
     *  **2+U(5,2)**2+U(6,2)**2)**(3.0D0/2.0D0)+U(4,2)*U(5,2)*cos(atan2(
     *  X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2))**2/(
     *  U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)
     *  **2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))*
     *  1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**(3.0D0/2.0D0)-(U(4,2)*cos
     *  (atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/(abs(U(4,2))**
     *  2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,
     *  2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))
     *  **(3.0D0/2.0D0)*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)*(U(5,2
     *  )*abs(U(4,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**2*
     *  2.0D0+U(5,2)*abs(U(5,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2
     *  )**2*2.0D0+U(5,2)*abs(U(6,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,
     *  2)**2)**2*2.0D0-(abs(U(5,2))*((U(5,2)/abs(U(5,2))))*2.0D0)/(U(4,
     *  2)**2+U(5,2)**2+U(6,2)**2)))/2.0D0+(U(5,2)*sin(atan2(X(2,1),X(1,
     *  1))-atan2(X(2,2),X(1,2)))*1.0D0/(abs(U(4,2))**2/(U(4,2)**2+U(5,2
     *  )**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)
     *  +abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))**(3.0D0/2.0D0)*
     *  1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)*(U(5,2)*abs(U(4,2))**2
     *  *1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**2*2.0D0+U(5,2)*abs(U(5,2
     *  ))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**2*2.0D0+U(5,2)*abs(
     *  U(6,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**2*2.0D0-(abs(U
     *  (5,2))*((U(5,2)/abs(U(5,2))))*2.0D0)/(U(4,2)**2+U(5,2)**2+U(6,2)
     *  **2)))/2.0D0)-U(5,2)*(U(4,2)*cos(atan2(X(2,1),X(1,1))-atan2(X(2,
     *  2),X(1,2)))*1.0D0/sqrt(abs(U(4,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2
     *  )**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))
     *  **2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/sqrt(U(4,2)**2+U(5,2)
     *  **2+U(6,2)**2)-U(5,2)*sin(atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,
     *  2)))*1.0D0/sqrt(abs(U(4,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)
     *  +abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(
     *  U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U
     *  (6,2)**2))*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)
      A(4,6,2) = sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)*(U(4,2)*U(6,2)*cos(
     *  atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2)
     *  )**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U
     *  (5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**
     *  2))*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**(3.0D0/2.0D0)-U(5,2)*
     *  U(6,2)*sin(atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt
     *  (abs(U(4,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(
     *  U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)
     *  **2+U(6,2)**2))*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**(3.0D0/
     *  2.0D0)-(U(4,2)*cos(atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*
     *  1.0D0/(abs(U(4,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2)
     *  )**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U
     *  (5,2)**2+U(6,2)**2))**(3.0D0/2.0D0)*1.0D0/sqrt(U(4,2)**2+U(5,2)
     *  **2+U(6,2)**2)*(U(6,2)*abs(U(4,2))**2*1.0D0/(U(4,2)**2+U(5,2)**
     *  2+U(6,2)**2)**2*2.0D0+U(6,2)*abs(U(5,2))**2*1.0D0/(U(4,2)**2+U(5
     *  ,2)**2+U(6,2)**2)**2*2.0D0+U(6,2)*abs(U(6,2))**2*1.0D0/(U(4,2)**
     *  2+U(5,2)**2+U(6,2)**2)**2*2.0D0-(abs(U(6,2))*((U(6,2)/abs(U(6,2)
     *  )))*2.0D0)/(U(4,2)**2+U(5,2)**2+U(6,2)**2)))/2.0D0+(U(5,2)*sin(
     *  atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/(abs(U(4,2))**2
     *  /(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2
     *  )**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))
     *  **(3.0D0/2.0D0)*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)*(U(6,2
     *  )*abs(U(4,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**2*
     *  2.0D0+U(6,2)*abs(U(5,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2
     *  )**2*2.0D0+U(6,2)*abs(U(6,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,
     *  2)**2)**2*2.0D0-(abs(U(6,2))*((U(6,2)/abs(U(6,2))))*2.0D0)/(U(4,
     *  2)**2+U(5,2)**2+U(6,2)**2)))/2.0D0)-U(6,2)*(U(4,2)*cos(atan2(X(2
     *  ,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2))**2/(U(4
     *  ,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**
     *  2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))*
     *  1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)-U(5,2)*sin(atan2(X(2,1
     *  ),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2))**2/(U(4,2
     *  )**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(
     *  6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/
     *  sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/sqrt(U(4,2)**2+U(5,2)
     *  **2+U(6,2)**2)
      A(5,4,2) = -sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)*(sin(atan2(X(2,1),
     *  X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2))**2/(U(4,2)
     *  **2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6
     *  ,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/
     *  sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)-U(4,2)**2*sin(atan2(X(2,1),X
     *  (1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2))**2/(U(4,2)**
     *  2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2
     *  )**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/(U(4
     *  ,2)**2+U(5,2)**2+U(6,2)**2)**(3.0D0/2.0D0)-U(4,2)*U(5,2)*cos(
     *  atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2)
     *  )**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U
     *  (5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**
     *  2))*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**(3.0D0/2.0D0)+(U(5,2)
     *  *cos(atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/(abs(U(4,2
     *  ))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**
     *  2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2
     *  )**2))**(3.0D0/2.0D0)*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)*
     *  (U(4,2)*abs(U(4,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**2*
     *  2.0D0+U(4,2)*abs(U(5,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2
     *  )**2*2.0D0+U(4,2)*abs(U(6,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,
     *  2)**2)**2*2.0D0-(abs(U(4,2))*((U(4,2)/abs(U(4,2))))*2.0D0)/(U(4,
     *  2)**2+U(5,2)**2+U(6,2)**2)))/2.0D0+(U(4,2)*sin(atan2(X(2,1),X(1,
     *  1))-atan2(X(2,2),X(1,2)))*1.0D0/(abs(U(4,2))**2/(U(4,2)**2+U(5,2
     *  )**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)
     *  +abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))**(3.0D0/2.0D0)*
     *  1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)*(U(4,2)*abs(U(4,2))**2
     *  *1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**2*2.0D0+U(4,2)*abs(U(5,2
     *  ))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**2*2.0D0+U(4,2)*abs(
     *  U(6,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**2*2.0D0-(abs(U
     *  (4,2))*((U(4,2)/abs(U(4,2))))*2.0D0)/(U(4,2)**2+U(5,2)**2+U(6,2)
     *  **2)))/2.0D0)-U(4,2)*(U(5,2)*cos(atan2(X(2,1),X(1,1))-atan2(X(2,
     *  2),X(1,2)))*1.0D0/sqrt(abs(U(4,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2
     *  )**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))
     *  **2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/sqrt(U(4,2)**2+U(5,2)
     *  **2+U(6,2)**2)+U(4,2)*sin(atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,
     *  2)))*1.0D0/sqrt(abs(U(4,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)
     *  +abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(
     *  U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U
     *  (6,2)**2))*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)
      A(5,5,2) = -sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)*(cos(atan2(X(2,1),
     *  X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2))**2/(U(4,2)
     *  **2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6
     *  ,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/
     *  sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)-U(5,2)**2*cos(atan2(X(2,1),X
     *  (1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2))**2/(U(4,2)**
     *  2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2
     *  )**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/(U(4
     *  ,2)**2+U(5,2)**2+U(6,2)**2)**(3.0D0/2.0D0)-U(4,2)*U(5,2)*sin(
     *  atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2)
     *  )**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U
     *  (5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**
     *  2))*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**(3.0D0/2.0D0)+(U(5,2)
     *  *cos(atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/(abs(U(4,2
     *  ))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**
     *  2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2
     *  )**2))**(3.0D0/2.0D0)*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)*
     *  (U(5,2)*abs(U(4,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**2*
     *  2.0D0+U(5,2)*abs(U(5,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2
     *  )**2*2.0D0+U(5,2)*abs(U(6,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,
     *  2)**2)**2*2.0D0-(abs(U(5,2))*((U(5,2)/abs(U(5,2))))*2.0D0)/(U(4,
     *  2)**2+U(5,2)**2+U(6,2)**2)))/2.0D0+(U(4,2)*sin(atan2(X(2,1),X(1,
     *  1))-atan2(X(2,2),X(1,2)))*1.0D0/(abs(U(4,2))**2/(U(4,2)**2+U(5,2
     *  )**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)
     *  +abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))**(3.0D0/2.0D0)*
     *  1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)*(U(5,2)*abs(U(4,2))**2
     *  *1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**2*2.0D0+U(5,2)*abs(U(5,2
     *  ))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**2*2.0D0+U(5,2)*abs(
     *  U(6,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**2*2.0D0-(abs(U
     *  (5,2))*((U(5,2)/abs(U(5,2))))*2.0D0)/(U(4,2)**2+U(5,2)**2+U(6,2)
     *  **2)))/2.0D0)-U(5,2)*(U(5,2)*cos(atan2(X(2,1),X(1,1))-atan2(X(2,
     *  2),X(1,2)))*1.0D0/sqrt(abs(U(4,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2
     *  )**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))
     *  **2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/sqrt(U(4,2)**2+U(5,2)
     *  **2+U(6,2)**2)+U(4,2)*sin(atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,
     *  2)))*1.0D0/sqrt(abs(U(4,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)
     *  +abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(
     *  U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U
     *  (6,2)**2))*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)
      A(5,6,2) = sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)*(U(5,2)*U(6,2)*cos(
     *  atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2)
     *  )**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U
     *  (5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**
     *  2))*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**(3.0D0/2.0D0)+U(4,2)*
     *  U(6,2)*sin(atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt
     *  (abs(U(4,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(
     *  U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)
     *  **2+U(6,2)**2))*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**(3.0D0/
     *  2.0D0)-(U(5,2)*cos(atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*
     *  1.0D0/(abs(U(4,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2)
     *  )**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U
     *  (5,2)**2+U(6,2)**2))**(3.0D0/2.0D0)*1.0D0/sqrt(U(4,2)**2+U(5,2)
     *  **2+U(6,2)**2)*(U(6,2)*abs(U(4,2))**2*1.0D0/(U(4,2)**2+U(5,2)**
     *  2+U(6,2)**2)**2*2.0D0+U(6,2)*abs(U(5,2))**2*1.0D0/(U(4,2)**2+U(5
     *  ,2)**2+U(6,2)**2)**2*2.0D0+U(6,2)*abs(U(6,2))**2*1.0D0/(U(4,2)**
     *  2+U(5,2)**2+U(6,2)**2)**2*2.0D0-(abs(U(6,2))*((U(6,2)/abs(U(6,2)
     *  )))*2.0D0)/(U(4,2)**2+U(5,2)**2+U(6,2)**2)))/2.0D0-(U(4,2)*sin(
     *  atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/(abs(U(4,2))**2
     *  /(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2
     *  )**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))
     *  **(3.0D0/2.0D0)*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)*(U(6,2
     *  )*abs(U(4,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**2*
     *  2.0D0+U(6,2)*abs(U(5,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2
     *  )**2*2.0D0+U(6,2)*abs(U(6,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,
     *  2)**2)**2*2.0D0-(abs(U(6,2))*((U(6,2)/abs(U(6,2))))*2.0D0)/(U(4,
     *  2)**2+U(5,2)**2+U(6,2)**2)))/2.0D0)-U(6,2)*(U(5,2)*cos(atan2(X(2
     *  ,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2))**2/(U(4
     *  ,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**
     *  2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))*
     *  1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)+U(4,2)*sin(atan2(X(2,1
     *  ),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2))**2/(U(4,2
     *  )**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(
     *  6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/
     *  sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/sqrt(U(4,2)**2+U(5,2)
     *  **2+U(6,2)**2)
      A(6,4,2) = sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)*(U(4,2)*U(6,2)*cos(
     *  atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2)
     *  )**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U
     *  (5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**
     *  2))*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**(3.0D0/2.0D0)-(U(6,2)
     *  *cos(atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/(abs(U(4,2
     *  ))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**
     *  2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2
     *  )**2))**(3.0D0/2.0D0)*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)*
     *  (U(4,2)*abs(U(4,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**2*
     *  2.0D0+U(4,2)*abs(U(5,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2
     *  )**2*2.0D0+U(4,2)*abs(U(6,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,
     *  2)**2)**2*2.0D0-(abs(U(4,2))*((U(4,2)/abs(U(4,2))))*2.0D0)/(U(4,
     *  2)**2+U(5,2)**2+U(6,2)**2)))/2.0D0-U(4,2)*U(6,2)*(cos(atan2(X(2,
     *  1),X(1,1))-atan2(X(2,2),X(1,2)))-1.0D0)*1.0D0/sqrt(abs(U(4,2))**
     *  2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,
     *  2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))
     *  *1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**(3.0D0/2.0D0)+(U(6,2)*(
     *  cos(atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))-1.0D0)*1.0D0/(abs
     *  (U(4,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,
     *  2)**2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U
     *  (6,2)**2))**(3.0D0/2.0D0)*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)
     *  **2)*(U(4,2)*abs(U(4,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2
     *  )**2*2.0D0+U(4,2)*abs(U(5,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,
     *  2)**2)**2*2.0D0+U(4,2)*abs(U(6,2))**2*1.0D0/(U(4,2)**2+U(5,2)**
     *  2+U(6,2)**2)**2*2.0D0-(abs(U(4,2))*((U(4,2)/abs(U(4,2))))*2.0D0)
     *  /(U(4,2)**2+U(5,2)**2+U(6,2)**2)))/2.0D0)-U(4,2)*(U(6,2)*cos(
     *  atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2)
     *  )**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U
     *  (5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**
     *  2))*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)-U(6,2)*(cos(atan2(
     *  X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))-1.0D0)*1.0D0/sqrt(abs(U(4,2
     *  ))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**
     *  2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2
     *  )**2))*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/sqrt(U(4
     *  ,2)**2+U(5,2)**2+U(6,2)**2)
      A(6,5,2) = sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)*(U(5,2)*U(6,2)*cos(
     *  atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2)
     *  )**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U
     *  (5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**
     *  2))*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**(3.0D0/2.0D0)-(U(6,2)
     *  *cos(atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/(abs(U(4,2
     *  ))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**
     *  2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2
     *  )**2))**(3.0D0/2.0D0)*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)*
     *  (U(5,2)*abs(U(4,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**2*
     *  2.0D0+U(5,2)*abs(U(5,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2
     *  )**2*2.0D0+U(5,2)*abs(U(6,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,
     *  2)**2)**2*2.0D0-(abs(U(5,2))*((U(5,2)/abs(U(5,2))))*2.0D0)/(U(4,
     *  2)**2+U(5,2)**2+U(6,2)**2)))/2.0D0-U(5,2)*U(6,2)*(cos(atan2(X(2,
     *  1),X(1,1))-atan2(X(2,2),X(1,2)))-1.0D0)*1.0D0/sqrt(abs(U(4,2))**
     *  2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,
     *  2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))
     *  *1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**(3.0D0/2.0D0)+(U(6,2)*(
     *  cos(atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))-1.0D0)*1.0D0/(abs
     *  (U(4,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,
     *  2)**2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U
     *  (6,2)**2))**(3.0D0/2.0D0)*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)
     *  **2)*(U(5,2)*abs(U(4,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2
     *  )**2*2.0D0+U(5,2)*abs(U(5,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,
     *  2)**2)**2*2.0D0+U(5,2)*abs(U(6,2))**2*1.0D0/(U(4,2)**2+U(5,2)**
     *  2+U(6,2)**2)**2*2.0D0-(abs(U(5,2))*((U(5,2)/abs(U(5,2))))*2.0D0)
     *  /(U(4,2)**2+U(5,2)**2+U(6,2)**2)))/2.0D0)-U(5,2)*(U(6,2)*cos(
     *  atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2)
     *  )**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U
     *  (5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**
     *  2))*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)-U(6,2)*(cos(atan2(
     *  X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))-1.0D0)*1.0D0/sqrt(abs(U(4,2
     *  ))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**
     *  2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2
     *  )**2))*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/sqrt(U(4
     *  ,2)**2+U(5,2)**2+U(6,2)**2)
      A(6,6,2) = -sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)*(cos(atan2(X(2,1),
     *  X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2))**2/(U(4,2)
     *  **2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6
     *  ,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/
     *  sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)-(cos(atan2(X(2,1),X(1,1))-
     *  atan2(X(2,2),X(1,2)))-1.0D0)*1.0D0/sqrt(abs(U(4,2))**2/(U(4,2)**
     *  2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2
     *  )**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/sqrt
     *  (U(4,2)**2+U(5,2)**2+U(6,2)**2)+U(6,2)**2*(cos(atan2(X(2,1),X(1,
     *  1))-atan2(X(2,2),X(1,2)))-1.0D0)*1.0D0/sqrt(abs(U(4,2))**2/(U(4,
     *  2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U
     *  (6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/
     *  (U(4,2)**2+U(5,2)**2+U(6,2)**2)**(3.0D0/2.0D0)-U(6,2)**2*cos(
     *  atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2)
     *  )**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U
     *  (5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**
     *  2))*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**(3.0D0/2.0D0)+(U(6,2)
     *  *cos(atan2(X(2,1),X(1,1))-atan2(X(2,2),X(1,2)))*1.0D0/(abs(U(4,2
     *  ))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**
     *  2+U(5,2)**2+U(6,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2
     *  )**2))**(3.0D0/2.0D0)*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)*
     *  (U(6,2)*abs(U(4,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**2*
     *  2.0D0+U(6,2)*abs(U(5,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2
     *  )**2*2.0D0+U(6,2)*abs(U(6,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,
     *  2)**2)**2*2.0D0-(abs(U(6,2))*((U(6,2)/abs(U(6,2))))*2.0D0)/(U(4,
     *  2)**2+U(5,2)**2+U(6,2)**2)))/2.0D0-(U(6,2)*(cos(atan2(X(2,1),X(1
     *  ,1))-atan2(X(2,2),X(1,2)))-1.0D0)*1.0D0/(abs(U(4,2))**2/(U(4,2)
     *  **2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6
     *  ,2)**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))**(3.0D0/
     *  2.0D0)*1.0D0/sqrt(U(4,2)**2+U(5,2)**2+U(6,2)**2)*(U(6,2)*abs(U(4
     *  ,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**2*2.0D0+U(6,2)*
     *  abs(U(5,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**2*2.0D0+U(
     *  6,2)*abs(U(6,2))**2*1.0D0/(U(4,2)**2+U(5,2)**2+U(6,2)**2)**2*
     *  2.0D0-(abs(U(6,2))*((U(6,2)/abs(U(6,2))))*2.0D0)/(U(4,2)**2+U(5,
     *  2)**2+U(6,2)**2)))/2.0D0)-U(6,2)*(U(6,2)*cos(atan2(X(2,1),X(1,1)
     *  )-atan2(X(2,2),X(1,2)))*1.0D0/sqrt(abs(U(4,2))**2/(U(4,2)**2+U(5
     *  ,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2)
     *  +abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/sqrt(U(4,
     *  2)**2+U(5,2)**2+U(6,2)**2)-U(6,2)*(cos(atan2(X(2,1),X(1,1))-
     *  atan2(X(2,2),X(1,2)))-1.0D0)*1.0D0/sqrt(abs(U(4,2))**2/(U(4,2)**
     *  2+U(5,2)**2+U(6,2)**2)+abs(U(5,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2
     *  )**2)+abs(U(6,2))**2/(U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/sqrt
     *  (U(4,2)**2+U(5,2)**2+U(6,2)**2))*1.0D0/sqrt(U(4,2)**2+U(5,2)**
     *  2+U(6,2)**2)
      A(3,3,3) = -X(3,1)+X(3,2)




        DO K=1,N
          JDOF(1,K) = 1
          JDOF(2,K) = 2
          JDOF(3,K) = 3
          JDOF(4,K) = 4
          JDOF(5,K) = 5
          JDOF(6,K) = 6
        END DO

      DO K = 1,MDOF        
        if (UE(K).NE. UE(K)) THEN
                UE(K) = 0.d0
        endif
      ENDDO
      DO K = 1, N
          DO I = 1, MDOF
              DO J = 1, MDOF
                  IF (A(I,J,K).NE.A(I,J,K)) THEN  ! Introduce NaN-like behavior
                      A(I, J, K) = 0.d0
                  ENDIF
              ENDDO
          ENDDO
      ENDDO

      END IF
      RETURN
      END